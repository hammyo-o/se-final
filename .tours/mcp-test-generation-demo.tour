{
  "$schema": "https://aka.ms/codetour-schema",
  "title": "AI-Powered Test Coverage Improvement Demo",
  "steps": [
    {
      "file": "README.md",
      "description": "# Welcome to AI-Powered Test Coverage Improvement\n## Project Overview\nThis system demonstrates **intelligent automated test generation** for Apache Commons Lang3:\n\nâœ… **Automated JUnit 4 test generation** for low-coverage classes\nâœ… **Significant coverage improvements** through iterative testing\nâœ… **Complete automation**: Coverage analysis â†’ Test generation â†’ Git workflow\nâœ… **Production-ready**: Context-aware generation, proper JUnit 4 syntax, comprehensive assertions\n### Technology Stack\n- **MCP Server**: FastMCP with 10 intelligent tools\n- **Coverage**: JaCoCo 0.8.12 for detailed metrics\n- **AI Integration**: Context-aware test generation\n- **Version Control**: Automated Git commit/push workflow",
      "line": 1
    },
    {
      "file": "README.md",
      "description": "## Project Structure\n\nKey components:\n- **`codebase/`** - Apache Commons Lang3 (our target for improvement)\n- **`mcp-agent/`** - MCP server with AI tools\n- **`testing-agent-demo/`** - Smaller demo project\n- **`scripts/`** - Coverage utilities\n- **`mcp-agent/docs/`** - Team reflection document\n\nThe MCP agent automates the entire test generation workflow.",
      "line": 208
    },
    {
      "file": "mcp-agent/server.py",
      "description": "## ðŸ§  MCP Server Architecture\n\n**FastMCP Server with 10 Intelligent Tools:**\n\n### Coverage Analysis (5 tools)\n- `analyze_coverage()` - Parse JaCoCo XML, identify targets (<90% coverage, >50 instructions)\n- `run_verify_with_coverage()` - Execute Maven verify with 5-min timeout\n- `run_tests()` - Quick test execution for verification\n- `identify_failing_tests()` - Parse surefire reports for debugging\n- `get_class_source()` - Retrieve source code for context-aware generation\n\n### Test Generation (1 tool)\n- `generate_junit4_tests()` - Create targeted JUnit 4 tests (basic/boundary/null_safety)\n\n### Git Automation (4 tools)\n- `git_status()`, `git_add_all()`, `git_commit()`, `git_push()`\n\n**Key Features:**\n- Portable paths (works from any directory)\n- Context-aware analysis before generation\n- JUnit 4 compatibility enforcement\n- Descriptive error messages",
      "line": 1
    },
    {
      "file": "codebase/pom.xml",
      "description": "## JaCoCo Configuration\n\nJaCoCo is configured in Maven to:\n- Run during the `verify` phase\n- Generate XML reports at `target/site/jacoco/jacoco.xml`\n- Create HTML reports for visualization\n- Track instruction and branch coverage\n\nThis is what powers our automated coverage measurement.",
      "line": 145,
      "pattern": "jacoco-maven-plugin"
    },
    {
      "file": "mcp-agent/coverage_parser.py",
      "description": "## ðŸ“Š JaCoCo Coverage Parser\n\n**Intelligent Analysis Tool:**\n\nParses `codebase/target/site/jacoco/jacoco.xml` to extract:\n- **Instruction Coverage** (bytecode-level granularity)\n- **Branch Coverage** (conditional logic paths)\n- **Line Coverage** (source code execution)\n- **Complexity Metrics** (cyclomatic complexity)\n\n**Selection Algorithm:**\n1. Filter: coverage < 90%\n2. Filter: instruction count > 50 (skip trivial classes)\n3. Sort: by instruction coverage (ascending)\n4. Return: Top 10 targets\n\n**Output Format:**\n```python\n{\n  \"class\": \"org.apache.commons.lang3.builder.StandardToStringStyle\",\n  \"instruction_coverage\": 32.0,\n  \"missed_instructions\": 102,\n  \"total_instructions\": 150\n}\n```\n\nThis context-aware analysis ensures effort is focused on high-impact targets, not already-tested code.",
      "line": 1
    },
    {
      "file": "codebase/src/test/java/org/apache/commons/lang3/builder/StandardToStringStyleExtendedTest.java",
      "description": "## âœ… Generated Test Example & Iterative Workflow\n\n**Example Test Generated by MCP Agent:**\n\n```java\n@Test\npublic void testUseClassNameGetterSetter() {\n    assertTrue(\"Default useClassName should be true\", style.isUseClassName());\n    style.setUseClassName(false);\n    assertFalse(\"useClassName should be false after setting\", style.isUseClassName());\n}\n```\n\n**Complete Iterative Testing Workflow:**\n\n1. **Initial Coverage Run** - `run_verify_with_coverage()` to generate fresh JaCoCo reports (5 min timeout)\n2. **Identify Targets** - `analyze_coverage()` finds classes <90% coverage with >50 instructions\n3. **Check Test Health** - `identify_failing_tests()` detects any existing test failures to fix first\n4. **Understand Context** - `get_class_source(class_name, package_name)` retrieves implementation details\n5. **Generate Tests** - `generate_junit4_tests(class_name, package_name, test_type)` creates boundary/null_safety/basic tests\n6. **Verify & Measure** - `run_tests()` validates compilation, then `run_verify_with_coverage()` measures improvement\n7. **Git Workflow** - `git_status()` â†’ `git_add_all()` â†’ `git_commit(message)` â†’ optional `git_push()`\n8. **Iterate** - Repeat steps 4-7 for next target class (3-5 improvement cycles typical)\n\n**Example Session:**\n```\n@tester improve test coverage of ./codebase\nâ†’ Analyzes TypeUtils at 68% coverage\nâ†’ Generates 26 tests (null assignability, type checking, array operations)\nâ†’ Commits: \"test: add 26 TypeUtils tests for type assignability and reflection\"\nâ†’ Coverage: 2397 â†’ 2454 tests (+57 session total)\n```\n\n**Key Features:**\n- **Iterative approach**: Multiple small commits showing measurable progress\n- **Real bug detection**: Tests expose actual codebase issues requiring fixes\n- **Context-aware**: Analyzes source patterns to generate idiomatic JUnit 4 tests\n- **Comprehensive coverage**: Targets edge cases (null, boundary, exceptions)\n- **Tracked progress**: Each commit documents coverage metrics and test counts",
      "line": 1,
      "selection": {
        "start": {
          "line": 27,
          "character": 11
        },
        "end": {
          "line": 32,
          "character": 4
        }
      }
    }
  ],
  "ref": "chore/import-friend-merge"
}